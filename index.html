<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Tracking App</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
</head>
<body>

    <div class="container">
        <!-- Sign In Form -->
        <div id="signin" class="form-container">
            <h2>Sign In</h2>
            <form id="signin-form">
                <input type="email" id="signin-email" placeholder="Email" required>
                <input type="password" id="signin-password" placeholder="Password" required>
                <button type="submit">Sign In</button>
                <p>Don't have an account? <a href="javascript:void(0)" onclick="toggleForm('signup')">Sign Up</a></p>
            </form>
        </div>

        <!-- Sign Up Form -->
        <div id="signup" class="form-container" style="display:none;">
            <h2>Sign Up</h2>
            <form id="signup-form">
                <input type="email" id="signup-email" placeholder="Email" required>
                <input type="password" id="signup-password" placeholder="Password" required>
                <button type="submit">Sign Up</button>
                <p>Already have an account? <a href="javascript:void(0)" onclick="toggleForm('signin')">Sign In</a></p>
            </form>
        </div>

        <!-- Dashboard (visible after login) -->
        <div id="dashboard" style="display:none;">
            <h2>Welcome to Patient Tracking App</h2>
            <button onclick="showAddPatientForm()">Add Patient</button>
            <button onclick="viewPatients()">View Patients</button>
            <button onclick="logout()">Logout</button>

            <div id="add-patient-form" class="form-container" style="display:none;">
                <h2>Add Patient Details</h2>
                <form id="patient-form">
                    <input type="text" id="patient-name" placeholder="Name" required>
                    <input type="number" id="patient-age" placeholder="Age" required>
                    <select id="patient-gender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                    <textarea id="patient-address" placeholder="Address" required></textarea>
                    <textarea id="patient-symptoms" placeholder="Symptoms" required></textarea>
                    <button type="submit">Add Patient</button>
                </form>
            </div>

            <div id="patient-list"></div>
        </div>
    </div>

    <script>
        // Firebase Config
        const firebaseConfig = {
              apiKey: "AIzaSyBvfmnKxsyKGpvdULLYv6SYHqfgRlWO75M",
  authDomain: "mrpi-40e83.firebaseapp.com",
  databaseURL: "https://mrpi-40e83-default-rtdb.firebaseio.com",
  projectId: "mrpi-40e83",
  storageBucket: "mrpi-40e83.firebasestorage.app",
  messagingSenderId: "1074708876532",
  appId: "1:1074708876532:web:4d896e384c1e5a7893e2a1",
  measurementId: "G-KBSLZZH0EX"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        // Toggle between Sign Up and Sign In forms
        function toggleForm(form) {
            document.getElementById('signin').style.display = form === 'signin' ? 'block' : 'none';
            document.getElementById('signup').style.display = form === 'signup' ? 'block' : 'none';
        }

        // Sign In
        document.getElementById('signin-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const email = document.getElementById('signin-email').value;
            const password = document.getElementById('signin-password').value;

            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    toggleDashboard();
                })
                .catch(error => {
                    alert('Error: ' + error.message);
                });
        });

        // Sign Up
        document.getElementById('signup-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;

            auth.createUserWithEmailAndPassword(email, password)
                .then(() => {
                    alert('User created successfully! Please Sign In.');
                    toggleForm('signin');
                })
                .catch(error => {
                    alert('Error: ' + error.message);
                });
        });

        // Toggle to Dashboard view
        function toggleDashboard() {
            document.getElementById('signin').style.display = 'none';
            document.getElementById('signup').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }

        // Add Patient
        document.getElementById('patient-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const name = document.getElementById('patient-name').value;
            const age = document.getElementById('patient-age').value;
            const gender = document.getElementById('patient-gender').value;
            const address = document.getElementById('patient-address').value;
            const symptoms = document.getElementById('patient-symptoms').value;

            const patient = {
                name,
                age,
                gender,
                address,
                symptoms
            };

            // Save patient data to Firebase Realtime Database
            const patientRef = db.ref('patients/' + new Date().getTime());
            patientRef.set(patient)
                .then(() => {
                    alert('Patient added successfully!');
                    document.getElementById('patient-form').reset();
                    document.getElementById('add-patient-form').style.display = 'none';
                })
                .catch(error => {
                    alert('Error saving patient data: ' + error.message);
                });
        });

        // Show the add patient form
        function showAddPatientForm() {
            document.getElementById('add-patient-form').style.display = 'block';
        }

        // View Patients
        function viewPatients() {
            const patientList = document.getElementById('patient-list');
            const patientsRef = db.ref('patients/');
            patientsRef.once('value', (snapshot) => {
                patientList.innerHTML = '';
                const patients = snapshot.val();
                if (patients) {
                    Object.keys(patients).forEach(key => {
                        const patient = patients[key];
                        const li = document.createElement('li');
                        li.textContent = `Name: ${patient.name}, Age: ${patient.age}, Gender: ${patient.gender}`;
                        patientList.appendChild(li);
                    });
                } else {
                    patientList.innerHTML = '<li>No patients found.</li>';
                }
            });
        }

        // Logout
        function logout() {
            auth.signOut()
                .then(() => {
                    alert('You have logged out');
                    document.getElementById('dashboard').style.display = 'none';
                    toggleForm('signin');
                })
                .catch(error => {
                    alert('Error logging out: ' + error.message);
                });
        }
    </script>

</body>
</html>
